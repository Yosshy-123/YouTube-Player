<!DOCTYPE html>
<html lang="ja">
<head>
	<meta charset="UTF-8">
	<meta content="width=device-width, initial-scale=1.0" name="viewport">
	<title>YouTube Player</title>
	<style>
	   :root {
	     --primary: #ff5555;
	     --primary-hover: #e64545;
	     --bg: #ffffff;
	     --text: #333;
	     --input-bg: #f9f9f9;
	     --input-border: #ccc;
	     --radius: 8px;
	     --transition: 0.3s ease;
	   }
	   html, body {
	     margin: 0;
	     padding: 0;
	     height: 100%;
	     font-family: system-ui, sans-serif;
	     background-color: var(--bg);
	     color: var(--text);
	     overflow: hidden;
	   }
	   #inputArea {
	     display: flex;
	     flex-direction: column;
	     justify-content: center;
	     align-items: center;
	     height: 100%;
	     padding: 2rem;
	     text-align: center;
	     gap: 2rem;
	   }
	   .formSection {
	     display: flex;
	     flex-direction: column;
	     gap: 1rem;
	     align-items: center;
	     width: 100%;
	     max-width: 500px;
	   }
	   .formSection p {
	     margin: 0;
	     font-size: 0.95rem;
	     color: #666;
	     text-align: center;
	     line-height: 1.4;
	   }
	   h2 {
	     font-size: clamp(1.2rem, 2vw, 1.5rem);
	     margin: 0;
	   }
	   input[type="text"] {
	     padding: 0.75em 1em;
	     font-size: 1.1rem;
	     border: 2px solid var(--input-border);
	     border-radius: var(--radius);
	     background: var(--input-bg);
	     color: var(--text);
	     width: 100%;
	     box-sizing: border-box;
	     outline: none;
	     transition: border-color var(--transition), box-shadow var(--transition);
	   }
	   input[type="text"]:focus {
	     border-color: var(--primary);
	     box-shadow: 0 0 0 3px rgba(255, 85, 85, 0.2);
	   }
	   button {
	     padding: 0.75em 1.5em;
	     font-size: 1.1rem;
	     border: none;
	     border-radius: var(--radius);
	     background-color: var(--primary);
	     color: white;
	     cursor: pointer;
	     transition: background-color var(--transition), transform var(--transition);
	   }
	   button:hover {
	     background-color: var(--primary-hover);
	     transform: translateY(-2px);
	   }
	   @media (max-width: 900px) {
	     #inputArea {
	       padding: 1rem;
	       gap: 1.5rem;
	     }
	     .formSection {
	       width: 100%;
	       max-width: 100%;
	     }
	     h2 {
	       font-size: 1.2rem;
	     }
	     input[type="text"], button {
	       font-size: 1rem;
	       width: 95%;
	     }
	   }
	   @media (max-width: 600px) {
	     #inputArea {
	       padding: 0.5rem;
	       gap: 1rem;
	     }
	     .formSection {
	       gap: 0.75rem;
	     }
	     .formSection p {
	       font-size: 0.85rem;
	     }
	     h2 {
	       font-size: 1rem;
	     }
	     input[type="text"], button {
	       font-size: 0.95rem;
	       width: 100%;
	     }
	   }
	</style>
</head>
<body>
	<div id="inputArea">
		<div class="formSection">
			<h2>YouTube 動画再生</h2><input id="videoId" maxlength="200" placeholder="YouTubeの動画ID または URL" type="text"> <button onclick="loadPlayer()">再生</button>
		</div>
		<div class="formSection">
			<h2>YouTube 動画検索</h2>
			<p>β版</p><input id="searchKeyword" maxlength="200" placeholder="検索キーワード" type="text"> <button onclick="searchYoutube()">検索</button>
		</div>
	</div>
<script>
    const extractVideoId = (input) => {
     const idPattern = /^[a-zA-Z0-9_-]{11}$/;
     if (idPattern.test(input)) return input;
     try {
       const url = new URL(input);
       if (url.hostname.includes('youtube.com')) {
         if (url.searchParams.get('v')) return url.searchParams.get('v');
         if (url.pathname.startsWith('/shorts/')) return url.pathname.split('/')[2];
       }
       if (url.hostname.includes('youtu.be')) return url.pathname.slice(1);
     } catch {}
     return null;
    };

    const openSearch = (keyword) => {
     if (keyword) {
       window.open(`https://www.google.com/search?q=${encodeURIComponent(keyword)}+site:youtube.com/watch`, "_blank");
     } else {
       alert("検索キーワードを入力してください。");
     }
    };

    const loadPlayer = () => {
     const inputValue = document.getElementById('videoId').value.trim();
     const videoId = extractVideoId(inputValue);
     if (videoId) {
       document.open();
       document.write(`
<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta content="width=device-width, initial-scale=1.0" name="viewport">
  <title>YouTube Player</title>
    <style>
          :root {--primary:#ff5555;--primary-hover:#e64545;--bg:#fff;--text:#333;--input-bg:#f9f9f9;--input-border:#ccc;--radius:8px;--transition:0.3s ease;}
          html,body{margin:0;padding:0;height:100%;background:var(--bg);color:var(--text);font-family:system-ui,sans-serif;overflow:hidden;}
          #app{display:flex;flex-direction:column;height:100vh;overflow:hidden;}
          #topBar{display:flex;align-items:center;gap:.5rem;padding:.5rem;box-sizing:border-box;background:#f5f5f5;border-bottom:1px solid #ddd;width:100%;flex-shrink:0;min-height:48px;flex-wrap:wrap;}
          #videoInput,#searchInput{flex:1;padding:.5em 1em;font-size:1rem;border:2px solid var(--input-border);border-radius:var(--radius);background:var(--input-bg);color:var(--text);outline:none;transition:border-color var(--transition),box-shadow var(--transition);}
          #videoInput:focus,#searchInput:focus{border-color:var(--primary);box-shadow:0 0 0 3px rgba(255,85,85,.2);}
          #playBtn,#searchBtn{padding:.5em 1em;font-size:1rem;border:none;border-radius:var(--radius);background:var(--primary);color:#fff;cursor:pointer;transition:background-color var(--transition),transform var(--transition);}
          #playBtn:hover,#searchBtn:hover{background:var(--primary-hover);transform:translateY(-2px);}
          #playerFrame{flex:1 1 auto;width:100%;border:none;min-height:0;}
          @media(max-width:900px){#videoInput,#searchInput,#playBtn,#searchBtn{font-size:.95rem;}}
          @media(max-width:600px){#topBar{flex-direction:column;align-items:stretch;gap:.75rem;padding:.5rem;}#videoInput{width:100%;font-size:1rem;padding:.75em 1em;box-sizing:border-box;}#playBtn{width:100%;font-size:1rem;padding:.75em 0;}#searchInput,#searchBtn{display:none;}}
    <\/style>
<\/head>
<body>
    <div id="app">
        <div id="topBar">
            <input id="videoInput" placeholder="YouTubeの動画ID または URL" type="text" value="${videoId}"> <button id="playBtn">再生<\/button> <input id="searchInput" placeholder="検索キーワード" type="text"> <button id="searchBtn">検索<\/button>
        <\/div>
    <iframe id="playerFrame" src="https://www.youtube-nocookie.com/embed/${videoId}?autoplay=1&controls=1&modestbranding=1&rel=0&fs=1" allow="autoplay; fullscreen" allowfullscreen referrerpolicy="no-referrer-when-downgrade"></iframe>
    <\/div>
    <script>
		    const frame = document.getElementById('playerFrame');
			frame.setAttribute("tabindex", "0");
			frame.addEventListener('load', () => {
			  frame.focus();
			});
            const extractVideoId = (input) => {
            const idPattern = /^[a-zA-Z0-9_-]{11}$/;
            if (idPattern.test(input)) return input;
            try {
              const url = new URL(input);
              if (url.hostname.includes('youtube.com')) {
                if (url.searchParams.get('v')) return url.searchParams.get('v');
                if (url.pathname.startsWith('/shorts/')) return url.pathname.split('/')[2];
              }
              if (url.hostname.includes('youtu.be')) return url.pathname.slice(1);
            } catch {}
            return null;
          };
          const openSearch = ${openSearch.toString()};
          const play = () => {
            const val = document.getElementById('videoInput').value.trim();
            const vid = extractVideoId(val);
            if (vid) {
              document.getElementById('playerFrame').src =
                "https://www.youtube-nocookie.com/embed/" + vid + "?autoplay=1&controls=1&modestbranding=1&rel=0&fs=1";
            } else {
              openSearch(val);
            }
          };
          const search = () => {
            openSearch(document.getElementById('searchInput').value.trim());
          };
          document.getElementById('playBtn').addEventListener('click', play);
          document.getElementById('searchBtn').addEventListener('click', search);
          const bindEnter = (id, handler) => {
            document.getElementById(id).addEventListener('keydown', e => {
              if (e.key === 'Enter') handler();
            });
          };
          bindEnter('videoInput', play);
          bindEnter('searchInput', search);
          ['videoInput','searchInput'].forEach(id => {
            const el = document.getElementById(id);
            el.addEventListener('focus', () => el.select());
            el.addEventListener('mouseup', e => e.preventDefault());
          });
    <\/script>
<\/body>
<\/html>
`);
       document.close();
     } else {
       openSearch(inputValue);
     }
    };

    const searchYoutube = () => {
     openSearch(document.getElementById('searchKeyword').value.trim());
    };

    const bindEnter = (id, handler) => {
     document.getElementById(id).addEventListener('keydown', e => {
       if (e.key === 'Enter') handler();
     });
    };
    bindEnter('videoId', loadPlayer);
    bindEnter('searchKeyword', searchYoutube);
</script>
</body>
</html>
